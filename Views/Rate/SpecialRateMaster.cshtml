@using NewZapures_V2.Models
@model RateMaster
@{
    int Id = (int)ViewBag.Id;
    ViewBag.Title = "Rate of Special Category";
    ViewBag.Create = "Add Rate of Special Category";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var SpecialCategoryList = CollectionDropdown.GetSpecialCategoryList();
    bool access = false;
    //if (CurrentSessions.Edit == "True")
    //{
    access = true;
    //}
    //if (CurrentSessions.New == "True")
    //{
    //    access = true;
    //}
}


@section styles {
    <link href="~/plugins/dropify/css/dropify.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>

        .dr-pro-pic .dropify-wrapper, #settings_detail .dropify-wrapper {
            width: 100%;
            position: relative;
        }
    </style>
}
@if (access)
{
    <div class="row">
        <div class="col-sm-12">
            <div class="page-title-box">
                <div class="float-right">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item">E-Mitra@Home</li>
                        <li class="breadcrumb-item">Rate</li>
                        <li class="breadcrumb-item active">@ViewBag.Create</li>
                    </ol>
                </div>
                <h4 class="page-title">@ViewBag.Title</h4>
            </div><!--end page-title-box-->
        </div><!--end col-->
    </div>
    <div class="row">
        <div class="col-lg-12">
            @using (Html.BeginForm("SpecialCategoryEdit", "Rate", FormMethod.Post, new { @class = "formcreateupdate", @id = "frmAddUpdate", enctype = "multipart/form-data" }))
            {
                <input type="hidden" id="RateMasterId" name="RateMasterId" value="@Id" />
                <div class="card">
                    <div class="card-header">
                        <h4 class="mt-0 header-title float-left">New Special Category</h4>
                        <a class="btn btn-gradient-secondary waves-effect waves-light float-right" href="@Url.Action("Details", "Rate")"><i class="fas fa-arrow-left"></i>Back to List</a>
                        @*<button onclick="location.href='@Url.Action("Create")';return false;" class="btn btn-gradient-primary float-right waves-effect waves-light"><i class="mdi mdi-plus-circle-outline mr-2"></i> @ViewBag.Create</button>*@
                    </div>
                    <div class="card-body">
                        <div class="form-group is-empty row">
                            <label for="nameInput" class="col-sm-3 control-label">Special Category</label>
                            <div class="col-md-6">
                                <select class="singleselect" name="SpecialMasterid" id="SpecialMasterid" required>
                                    <option value="">--  Select  --</option>
                                    @{
                                        foreach (var item in SpecialCategoryList)
                                        {
                                            <option value="@item.Id">@item.Text</option>
                                        }
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="form-group is-empty row">
                            <label for="nameInput" class="col-sm-3 control-label">Department</label>
                            <div class="col-sm-6">
                                <input name="DepartmentCharge" id="DepartmentCharge" type="number" value="" class="form-control" placeholder="Enter Department charge" required>
                            </div>
                        </div>
                        <div class="form-group is-empty row">
                            <label for="nameInput" class="col-sm-3 control-label">Emitra</label>
                            <div class="col-sm-6">
                                <input name="EmitraCharge" id="EmitraCharge" type="number" value="" class="form-control" placeholder="Enter Emitra charge" required>
                            </div>
                        </div>
                        <div class="form-group is-empty row">
                            <label for="nameInput" class="col-sm-3 control-label">Active</label>
                            <div class="form-check form-switch col-sm-7" style="margin-left: 11px;">
                                <input class="form-check-input ChangeStatus" type="checkbox" value="0" name="IsActive" id="IsActive">

                            </div>
                        </div>
                    </div>
                </div>
                <footer class="form-footer">
                    <div class="pull-right" style="text-align: end;">
                        <a href="@Url.Action("Details", "Rate")" class="btn btn-default">DISCARD</a>
                        <button class="btn btn-primary"> Save </button>
                    </div>
                </footer>
            }
        </div>
    </div>
}
@section Scripts {
    <script src="~/plugins/dropify/js/dropify.min.js"></script>
    <script type="text/javascript">
        $(".singleselect").select2();
        $("#SpecialMasterid").change(function () {
            var Id = $(this).val();
            var RateMasterId = $("#RateMasterId").val();
            $('#IsActive').prop('checked', false);
            $("#IsActive").val('0');
            $("#DepartmentCharge").val('');
            $("#EmitraCharge").val('');
            var Params = JSON.stringify(
                {
                    Id: Id,
                    RateMasterId: RateMasterId
                });

            $.ajax({
                url: "/Rate/FillSpecialCategoryWiseRate",
                type: 'POST',
                dataType: "json",
                contentType: "application/json",
                data: Params,
                success: function (response) {

                    console.log(response);


                    for (var i = 0; i < response.Data.length; i++) {
                        debugger;
                        if (response.Data[0].IsActive == 1) {
                            $('#IsActive').prop('checked', true);
                            $("#IsActive").val('1');
                        }
                        else {
                            $('#IsActive').prop('checked', false);
                            $("#IsActive").val('0');
                        }
                        $("#DepartmentCharge").val(response.Data[0].DepartmentCharge);
                        $("#EmitraCharge").val(response.Data[0].EmitraCharge);
                    }



                }

            });
            return false;
        });
        $("#IsActive").change(function () {
            var id = $("#IsActive").val();
            if (id == 0) {
                $('#IsActive').prop('checked', true);
                $("#IsActive").val('1');
            }
            else {
                $('#IsActive').prop('checked', false);
                $("#IsActive").val('0');
            }
        });
    </script>

}
