@using NewZapures_V2.Models
@{
    ViewBag.Title = "Inspection Application";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var applData = (List<TrusteeBO.DraftApplication>)ViewBag.applicationDetails;

}
@section styles{  @*@Styles.Render("~/bundles/datatable");*@

<link href="~/plugins/datatables/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link href="~/plugins/datatables/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link href="~/plugins/datatables/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
<link href="~/Content/select2/css/select2.css" rel="stylesheet" />
}



<style type="text/css">
    .dropify-wrapper {
        display: block;
        position: relative;
        cursor: pointer;
        overflow: hidden;
        width: 100%;
        max-width: 100%;
        height: 138px;
        padding: 5px 10px;
        font-size: 14px;
        line-height: 22px;
        color: #777;
        background-color: #FFF;
        background-image: none;
        text-align: center;
        border: 2px solid #E5E5E5;
        -webkit-transition: border-color .15s linear;
        transition: border-color .15s linear;
    }

    .select2-container {
        z-index: 999999 !important;
    }

    .table thead {
        background-color: #646d91 !important;
    }

        .table thead > tr > th {
            color: white
        }


    .fsc {
        background: #6441A5;
        background: -webkit-linear-gradient(to left, #2a0845, #6441A5);
        background: linear-gradient(to left, #506ee4, #5b3a96);
        border-radius: 12px;
    }

        .fsc h4 {
            color: white !important;
        }
</style>
<div class="row">
    <div class="col-sm-12">
        <div class="page-title-box">
            <div class="float-right">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">NOC</li>
                    <li class="breadcrumb-item">Master</li>
                    <li class="breadcrumb-item active">Inspection Application</li>
                </ol>
            </div>
            <h4 class="page-title">@ViewBag.Title</h4>
        </div>
        @*end page-title-box*@
    </div><!--end col-->
</div>

<div class="card">
    <div class="card-header fsc" style="display: flex !important; align-items: baseline !important; place-content: space-between !important;">
        <h4 class="mt-0 header-title float-left">Application Inspection</h4>
        @*<a href="@Url.Action("EditApplication", "Trustee", new {applGUID=@draftAppl.ApplGuid})" class="btn btn-sm btn-gradient-dark"><i class="fa fa-arrow-left"></i> Back To Edit Application</a>*@
    </div>
    <div class="card-body">

        <div class="form-group is-empty row" id="showtable">
            <table id="datatable-buttons" class="table table-striped " style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                <thead>
                    <tr class="text-center">
                        <th>#</th>
                        <th>Application Number</th>
                        <th hidden>Application GUID</th>
                        <th hidden>DepartmentID</th>
                        <th>State</th>
                        <th>District</th>
                        <th>Tehsil</th>
                        <th>Trust</th>
                        <th>College</th>
                        <th>Contact No</th>
                        <th>Contact Person</th>
                        <th>Payment Receipt</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="DataAepslist">
                    @{
                        if (applData != null && applData.Count > 0)
                        {
                            var i = 1;
                            foreach (var item in applData)
                            {
                                <tr>
                                    <td>@i</td>
                                    <td>@item.ApplicationNumber</td>
                                    <td hidden>@item.ApplGuid</td>
                                    <td hidden>@item.iFKDEPT_ID</td>
                                    <td>@item.State</td>
                                    <td>@item.District</td>
                                    <td>@item.Tehsil</td>
                                    <td>@item.TrustName</td>
                                    <td>@item.CollegeName</td>
                                    <td>@item.ContactDetails</td>
                                    <td>@item.ContactPerson</td>
                                    <td class="text-center"><a href="@item.UploadedReceiptDocument" download="@item.ApplicationNumber-@i-Receipt" title="Download File" data-toggle='tooltip' data-placement='top'><i class="fa fa-download"></i> </a></td>
                                    <td><a href="@Url.Action("Draftinspaction", "Trustee", new {applGUID=item.ApplGuid})" class="link-primary">Proceed For Inspection</a></td>
                                </tr>
                            }
                            i++;
                        }
                        else
                        {
                            <tr><td class="text-center" colspan="11">No Data Available</td></tr>
                        }
                    }
                </tbody>
            </table>
        </div>

        @*Modal Start*@
        <div class="modal fade bd-example-modal-xl bounce animated" id="mComitee" tabindex="-1" role="dialog" aria-labelledby="mComitee" data-backdrop="static" style="display:none;">
            <div class="modal-dialog modal-xl modal-dialog-centered" role="document">
                <div class="modal-content" style="-webkit-box-shadow: -28px 28px 28px -11px rgba(181,181,181,1); -moz-box-shadow: -28px 28px 28px -11px rgba(181,181,181,1); box-shadow: -28px 28px 28px -11px rgb(180 170 170); border-radius: 50px;">
                    <div class="modal-header" style="border-radius: 51px;background: #22b1db;">
                        <div>
                            <h5 class="modal-title" id="mComitee" style="margin-left: 20px;color:white">
                                Application Number : <span id="spnAppNo">{{appNo}}</span>
                            </h5>
                        </div>
                        <button type="button" class="btn btn-sm btn-danger" data-dismiss="modal" aria-label="Close" style="margin-right: 20px;">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" style="padding: 36px;">

                        <div class="row">
                            <div class="form-group col-lg-12" id="divSelectComite">
                                <label for="example-text-input" class="col-sm-12" style="margin-left:-10px"><strong>Select Committee</strong></label>
                                <div>
                                    <select class="form-control" id="ddlComitee">
                                        <option value="0">Select Committee</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group col-lg-4" id="divDeleteEntries" syle="display:none">
                                <label for="example-text-input" class="col-sm-12" style="margin-left:-10px"><strong>&nbsp;</strong></label>
                                <button id="btnDeleteExisting" type="button" class="btn btn-primary col-lg-12" style="background: red !important;border-color: red !important;" onclick="SendMail("Delete")"><i class="fa fa-trash"></i>&nbsp; Delete Existing Assigned Committee</button>

                            </div>

                        </div>

                        <div class="row">
                            <div class="form-group col-lg-6">
                                <label for="example-text-input" class="col-sm-12" style="margin-left:-10px"><strong>Select Start Date (mm/dd/yyyy)</strong></label>
                                <div>
                                    <input type="date" id="txtStartDate" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label for="example-text-input" class="col-sm-12" style="margin-left:-10px"><strong>Select End Date (mm/dd/yyyy)</strong></label>
                                <div>
                                    <input type="date" id="txtEndDate" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group col-lg-6">
                                <label for="example-text-input" class="col-sm-12" style="margin-left:-10px"><strong>Select Start Time</strong></label>
                                <div>
                                    <input type="time" id="txtStartTime" class="form-control" />
                                </div>
                            </div>

                            <div class="form-group col-lg-6">
                                <label for="example-text-input" class="col-sm-12" style="margin-left:-10px"><strong>Select End Time</strong></label>
                                <div>
                                    <input type="time" id="txtEndTime" class="form-control" />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <table class="table table-striped table-borderless" id="tblCommitteeMembers">
                                <thead>
                                    <tr>
                                        <th hidden>UserCode</th>
                                        <th>SSO ID</th>
                                        <th>Member Name</th>
                                        <th>E-mail Address</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>

                        </div>

                        <div class="custom-control custom-checkbox">
                            <input type="checkbox" id="customCheck1" name="customCheck" class="custom-control-input">
                            <label class="custom-control-label" for="customCheck1" style="font-weight: 600;font-size: 14px;">Do you want to notify the committee members...?</label>
                        </div>
                        <div class="col-lg-12 mt-3 text-end">

                            <button id="btnNotify" type="button" class="btn btn-primary col-lg-2" style="display: none;background: #19c374!important;border-color: #19c374!important;"><i class="fa fa-bell"></i>&nbsp; Notify</button>
                            <button id="btnSubmit" type="button" class="btn btn-primary col-lg-4" style="background: #22b1db !important;border-color: #22b1db !important;"><i class="fa fa-plus"></i>&nbsp; Assign Committee</button>

                        </div>
                    </div>
                    @*<div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="CheckTermsAndCondition()">I Accept</button>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        </div>*@
                </div>
            </div>
        </div>

        @*Modal End*@




        @*<div class="accordion" id="accordionPanelsStayOpenExample">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="panelsStayOpen-headingOne">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
                            <i class="fa fa-school"></i>&nbsp; New College Subject TNOC
                        </button>
                    </h2>
                    <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
                        <div class="accordion-body row">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th>Application Number</th>
                                        <th>College</th>
                                        <th>Course</th>
                                        <th>District</th>
                                        <th>Tehsil</th>
                                        <th>Date Of Submission</th>
                                        <th>Payment Receipt</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="8" class="text-center">No Data Available</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="true" aria-controls="panelsStayOpen-collapseTwo">
                            <i class="fa fa-school"></i>&nbsp; College Subject PNOC
                        </button>
                    </h2>
                    <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingTwo">
                        <div class="accordion-body row">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th>Application Number</th>
                                        <th>College</th>
                                        <th>Course</th>
                                        <th>District</th>
                                        <th>Tehsil</th>
                                        <th>Date Of Submission</th>
                                        <th>Payment Receipt</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="8" class="text-center">No Data Available</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="panelsStayOpen-headingThree">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="true" aria-controls="panelsStayOpen-collapseThree">
                            <i class="fa fa-school"></i>&nbsp; Change In Name
                        </button>
                    </h2>
                    <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingThree">
                        <div class="accordion-body row">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th>Application Number</th>
                                        <th>College</th>
                                        <th>Course</th>
                                        <th>District</th>
                                        <th>Tehsil</th>
                                        <th>Date Of Submission</th>
                                        <th>Payment Receipt</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="8" class="text-center">No Data Available</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="panelsStayOpen-headingFour">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseFour" aria-expanded="true" aria-controls="panelsStayOpen-collapseFour">
                            <i class="fa fa-school"></i>&nbsp; Change Girls to Co-Edu
                        </button>
                    </h2>
                    <div id="panelsStayOpen-collapseFour" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingFour">
                        <div class="accordion-body row">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th>Application Number</th>
                                        <th>College</th>
                                        <th>Course</th>
                                        <th>District</th>
                                        <th>Tehsil</th>
                                        <th>Date Of Submission</th>
                                        <th>Payment Receipt</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="8" class="text-center">No Data Available</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="panelsStayOpen-headingFive">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseFive" aria-expanded="true" aria-controls="panelsStayOpen-collapseFive">
                            <i class="fa fa-school"></i>&nbsp; College Merge
                        </button>
                    </h2>
                    <div id="panelsStayOpen-collapseFive" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingFive">
                        <div class="accordion-body row">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th>Application Number</th>
                                        <th>College</th>
                                        <th>Course</th>
                                        <th>District</th>
                                        <th>Tehsil</th>
                                        <th>Date Of Submission</th>
                                        <th>Payment Receipt</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="8" class="text-center">No Data Available</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>*@


        @*<div class="formsCollection">Land and Building Information</div>
            <div class="formsCollection">Subject Covered</div>
            <div class="formsCollection">College Fee Structure</div><br />
            <div class="formsCollection">Architectrual Details</div>
            <div class="formsCollection">Other Facilites</div><br />
            <div class="formsCollection">Staff Details</div><br />
            <div class="formsCollection">Acadmy Information</div>
            <div class="formsCollection">Proof Document</div>*@
    </div>
</div>


@section scripts {
    <script src="~/plugins/datatables/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/dataTables.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/dataTables.buttons.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/jszip.min.js" type="text/javascript"></script>
    @*<script src="~/plugins/datatables/pdfmake.min.js" type="text/javascript"></script>*@
    <script src="~/plugins/datatables/vfs_fonts.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.html5.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.print.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.colVis.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/dataTables.responsive.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/responsive.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/scripts/pages/jquery.datatable.init.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
    <script src="~/Content/globalDomain.js"></script>
    <script src="~/Content/select2/js/select2.js"></script>
}
<script type="text/javascript">
    var selectedStartTime = "";
    var selectedEndTime = "";
    var existingAssignedData;
    $(document).ready(function () {
        $('#ddlComitee').select2();
        $('#ddlComitee').change(function () {
            var comiteID = $(this).val();
            if (comiteID > 0) {

                getCommitteeMembersList(comiteID);
            }

        });

        $('#btnSubmit').click(function () {
            AssignCommittee();
        });

        $("#txtStartDate").change(function () {
            var startdate = $(this).val();
            $("#txtEndDate").prop('disabled', false);
            document.getElementById("txtEndDate").min = startdate;
        });

        $("#txtStartTime").change(function () {
            var selectedTime = $(this).val();
            selectedStartTime = onTimeChange(selectedTime);
            //alert(selectedStartTime);

        });

        $("#txtEndTime").change(function () {
            var selectedTime = $(this).val();
            selectedEndTime = onTimeChange(selectedTime);
            //alert(selectedEndTime);

        });
    });

    $('#customCheck1').change(function () {
        var s = $("#customCheck1").is(':checked');
        if (s) {
            $('#btnNotify').css('display', 'initial');
        }
        else {
            $('#btnNotify').css('display', 'none');
        }
    });

    function openModal(applNumber, departmentID) {
        $('#spnAppNo').html('');
        $('#spnAppNo').html(applNumber);

        GetExistingCommitteeAsignment(applNumber, departmentID);
    }

    function getCommitteeList(deptID, committeeID) {
        var htmlString = `<option value="0">Select Committee</option>`;
        var RequestModel = {
            "deptID": parseInt(deptID),
        }

        var d = JSON.stringify(RequestModel);
        //console.log(d);
        $.ajax({
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            url: GetglobalDomain() + "/Admin/CommitteeList",
            dataType: 'json',
            type: 'Post',
            cache: false,
            data: JSON.stringify(RequestModel),
            success: function (data) {
                //console.log(data);

                var committeeData = data.Data;

                if (committeeData != null && committeeData.length > 0) {
                    committeeData.forEach(function (item) {
                        if (item.Id == committeeID) {

                            htmlString += `<option value=${item.Id} selected>${item.Text}</option>`;
                        }
                        else {
                            htmlString += `<option value=${item.Id}>${item.Text}</option>`;
                        }
                    });

                }
                $('#ddlComitee').html('');
                $('#ddlComitee').html(htmlString);
            },
            error: function (d) {
                //console.log(d);
            }
        });
    }

    function getCommitteeMembersList(CommitteeID) {
        var htmlString = "";
        var RequestModel = {
            "committeeID": parseInt(CommitteeID),
        }

        var d = JSON.stringify(RequestModel);
        //console.log(d);
        $.ajax({
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            url: GetglobalDomain() + "/Admin/CommitteeMembersList",
            dataType: 'json',
            type: 'Post',
            cache: false,
            data: JSON.stringify(RequestModel),
            success: function (data) {
                //console.log(data);

                var membersList = data.Data;

                if (membersList != null && membersList.length > 0) {
                    membersList.forEach(function (item) {
                        htmlString += `<tr><td hidden>${item.UserID}</td><td>${item.SSOID}</td><td>${item.Name}</td><td>${item.EmailAddress}</td></tr>`
                    });


                }
                else {
                    htmlString += `<tr><td colspan="3" class="text-center">No Data Available</td></tr>`
                }
                $('#tblCommitteeMembers tbody').html('');
                $('#tblCommitteeMembers tbody').html(htmlString);

            },
            error: function (d) {
                //console.log(d);
            }
        });
    }


    function GetExistingCommitteeAsignment(applNum, departmentID) {
        var status = 0;
        var RequestModel = {
            "applicationNumber": applNum,
        }

        var d = JSON.stringify(RequestModel);
        //console.log(d);
        $.ajax({
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            url: GetglobalDomain() + "/Admin/GetExistingCommitteeAsignment",
            dataType: 'json',
            type: 'Post',
            cache: false,
            data: JSON.stringify(RequestModel),
            success: function (data) {
                console.log(data);
                existingAssignedData = data.Data[0];
                if (existingAssignedData != null) {
                    /* alert('iside')*/
                    status = 1;
                    var isNotifyEnabled = existingAssignedData.isNotfy;
                    getCommitteeList(existingAssignedData.iDeptId, existingAssignedData.iFk_CmtyID);
                    getCommitteeMembersList(existingAssignedData.iFk_CmtyID);

                    //var d = new Date(existingAssignedData.dtStrtDate).toDateString();

                    //console.log(d);

                    var StartDateAndTime = new Date(existingAssignedData.dtStrtDate).toDateString() + " " + existingAssignedData.tStrttime;
                    var EndDateAndTime = new Date(existingAssignedData.dtEndDate).toDateString() + " " + existingAssignedData.tEndtime;
                    //console.log(StartDateAndTime);
                    //console.log(EndDateAndTime);

                    var startDatestrings = getHTML5DateAndTimeFromDate(StartDateAndTime);
                    $('#txtStartDate').val(startDatestrings[0])
                    $('#txtStartTime').val(startDatestrings[1]);
                    selectedStartTime = startDatestrings[1];

                    var endDatestrings = getHTML5DateAndTimeFromDate(EndDateAndTime);
                    $('#txtEndDate').val(endDatestrings[0])
                    $('#txtEndTime').val(endDatestrings[1]);
                    selectedEndTime = endDatestrings[1];

                    if (isNotifyEnabled == 1) {
                        $('#customCheck1').attr('checked', 'true');
                        $('#btnNotify').css('display', 'initial');
                    }
                    else {
                        $('#customCheck1').removeAttr('checked');
                        $('#btnNotify').css('display', 'none');
                    }
                    $('#divSelectComite').removeClass('col-lg-12').addClass('col-lg-8');
                    $('#divDeleteEntries').css('display', 'block');


                    $('#btnComiteeModal').click();
                }

                if (status == 0) {
                    getCommitteeList(departmentID);
                    $('#divSelectComite').removeClass('col-lg-8').addClass('col-lg-12');
                    $('#divDeleteEntries').css('display', 'none');

                    $('#btnComiteeModal').click();
                }
            },
            error: function (d) {
                //console.log(d);
            }
        });
    }

    function AssignCommittee() {

        var isNotify = $("#customCheck1").is(':checked');
        var commiteeID = $('#ddlComitee').val();
        var startDate = $('#txtStartDate').val();
        var startTime = $('#txtStartTime').val();
        var endDate = $('#txtEndDate').val();
        var endTime = endTime
        var appNo = $('#spnAppNo').html();

        var RequestModel = {
            "iFk_CmtyID": parseInt(commiteeID),
            "sApplNo": appNo,
            "isNotfy": (isNotify == true ? 1 : 0),
            "dtStrtDate": startDate,
            "tStrttime": selectedStartTime,
            "dtEndDate": endDate,
            "tEndtime": selectedEndTime
        }

        var d = JSON.stringify(RequestModel);
        console.log(d);
        if (checkValidate()) {
            $.ajax({
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                url: GetglobalDomain() + "/Admin/AssignCommitteeToApplication",
                dataType: 'json',
                type: 'Post',
                cache: false,
                data: JSON.stringify(RequestModel),
                success: function (data) {
                    console.log(data);

                    var statusCode = data.Data.statusCode;
                    var msg = data.Data.Message;

                    if (statusCode == 1) {
                        Swal.fire({
                            position: 'center',
                            icon: 'success',
                            title: msg,
                            showConfirmButton: true,
                        });
                        //SendMail('Send');
                    }

                    //setTimeout(function () {
                    //    location.reload();
                    //}, 1500);

                },
                error: function (d) {
                    //console.log(d);
                }
            });
        }
    }

    function checkValidate() {
        var status = true;
        var commiteeID = $('#ddlComitee').val();
        var startDate = $('#txtStartDate').val();
        var startTime = $('#txtStartTime').val();
        var endDate = $('#txtEndDate').val();
        var endTime = $('#txtEndTime').val();

        //alert(GroupName);
        if (commiteeID == 0) {
            Swal.fire({
                position: 'center',
                icon: 'error',
                title: 'Please Select Committee...!',
                allowOutsideClick: false,
                showCloseButton: true,
                showConfirmButton: false,
            })
            status = false;
        }
        else if (startDate.length <= 0) {
            Swal.fire({
                position: 'center',
                icon: 'error',
                title: 'Please Select Start Date...!',
                allowOutsideClick: false,
                showCloseButton: true,
                showConfirmButton: false,
            })
            status = false;
        }
        else if (endDate.length <= 0) {
            Swal.fire({
                position: 'center',
                icon: 'error',
                title: 'Please Select End Date...!',
                allowOutsideClick: false,
                showCloseButton: true,
                showConfirmButton: false,
            })
            status = false;
        }
        else if (startTime.length <= 0) {
            Swal.fire({
                position: 'center',
                icon: 'error',
                title: 'Please Select Start Time...!',
                allowOutsideClick: false,
                showCloseButton: true,
                showConfirmButton: false,
            })
            status = false;
        }
        else if (endTime.length <= 0) {
            Swal.fire({
                position: 'center',
                icon: 'error',
                title: 'Please Select End Time...!',
                allowOutsideClick: false,
                showCloseButton: true,
                showConfirmButton: false,
            })
            status = false;
        }
        return status;
    }

    function onTimeChange(InputTime) {
        var timeSplit = InputTime.split(':'),
            hours,
            minutes,
            meridian;
        hours = timeSplit[0];
        minutes = timeSplit[1];
        if (hours > 12) {
            meridian = 'PM';
            hours -= 12;
        } else if (hours < 12) {
            meridian = 'AM';
            if (hours == 0) {
                hours = 12;
            }
        } else {
            meridian = 'PM';
        }
        var Selectedtime = hours + ':' + minutes + ' ' + meridian

        return Selectedtime;
    }

    function getHTML5DateAndTimeFromDate(ddate) {

        var d = new Date(ddate);

        // Date string
        let ds = d.getFullYear().toString().padStart(4, '0') + '-' + (d.getMonth() + 1).toString().padStart(2, '0') + '-' + d.getDate().toString().padStart(2, '0');

        // Time string
        let ts = d.getHours().toString().padStart(2, '0') + ':' + d.getMinutes().toString().padStart(2, '0') + ':' + d.getSeconds().toString().padStart(2, '0');

        // Return them in array
        return [ds, ts];
        //return ds;
    }

    function SendMail(SendType) {

        var emailList = [];
        $('#tblCommitteeMembers > tbody  > tr ').each(function () {
            var emailAddress = $(this).find('td:eq(3)').html()
            emailList.push({
               "Emails":emailAddress
            })
        });

        var applNum = $('#spnAppNo').html();

        var RequestModel = {
            "applicationNumber": applNum,
            "EmailList": emailList,
            "type": SendType,
        }

        var d = JSON.stringify(RequestModel);
        console.log(d);
        $.ajax({
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            url: GetglobalDomain() + "/Admin/SendMail",
            dataType: 'json',
            type: 'Post',
            cache: false,
            data: JSON.stringify(RequestModel),
            success: function (data) {
                console.log(data);
            },
            error: function (d) {
                //console.log(d);
            }
        });




        //console.table(emailList);

    }

</script>