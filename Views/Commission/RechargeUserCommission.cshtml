@using NewZapures_V2.Models

@{

    Layout = "~/Views/Shared/_Layout.cshtml";
    List<CustomMaster> OperaterName = new List<CustomMaster>();
    if (ViewBag.OperaterName != null)
    {
        OperaterName = (List<CustomMaster>)ViewBag.OperaterName;
    }
    int serviceid = ViewBag.ServiceId;
    string userName = ViewBag.commissionFor;
    ViewBag.Title = userName + " Commission";
    //var uservalue = ViewBag.UserType;
    //var userName = "";
    //if (uservalue == 4)
    //{
    //    userName = "Retailer";
    //}
}
@section styles{-->  @*@Styles.Render("~/bundles/datatable");*@\
<link href="~/plugins/datatables/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link href="~/plugins/datatables/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link href="~/plugins/datatables/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">

}
<div class="row">
    <div class="col-sm-12">
        <div class="page-title-box">
            <div class="float-right">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">Zapures</li>
                    <li class="breadcrumb-item">User Commission</li>
                    <li class="breadcrumb-item active">Details</li>
                </ol>
            </div>
            <h4 class="page-title">@ViewBag.Title</h4>
        </div><!--end page-title-box-->
    </div><!--end col-->
</div>
<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header">
                <h4 class="mt-0 header-title float-left">@userName Commission</h4>
                <a class="btn btn-gradient-secondary waves-effect waves-light float-right" href="@Url.Action("RechargeCommissionIndex", "Commission")"><i class="fas fa-arrow-left"></i>Back</a>


            </div>
            <div class="card-body">
                @*@using (Html.BeginForm("UserCommission", "Commission", FormMethod.Post, new { @class = "formcreateupdate", @id = "frmAddUpdate", enctype = "multipart/form-data" }))
                    {*@
                <input name="Id" id="Id" type="hidden" value="@ViewBag.Id" />
                <input name="UserType" id="UserType" type="hidden" value="@ViewBag.UserType" />
                <input name="ServiceId" id="ServiceId" type="hidden" value="@ViewBag.ServiceId" />
                <input name="IsdefaultPartyId" id="IsdefaultPartyId" type="hidden" value="@ViewBag.IsdefaultPartyId" />
                @if (@serviceid == 5)
                {

                    <div class="form-group is-empty row">
                        <label for="nameInput" class="col-sm-3 control-label">Service Provider</label>
                        <div class="col-md-6">
                            <select class="singleselect" name="OperaterId" id="OperaterId" required>
                                <option value="">Select Operater </option>
                                @{
                                    foreach (var item in OperaterName)
                                    {
                                        <option value="@item.Id">@item.text</option>
                                    }
                                }
                            </select>

                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-primary" id="Recharge_Id">Change</button>
                        </div>
                        @*<div class="col-md-4">
                                <input type="number" id="" name="CommissionRate" min="0" placeholder="Enter Commission Rate" value="" class="form-control" required>

                            </div>*@
                    </div>
                    <div class="form-group is-empty row" id="rechargesdata">

                        @*<table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">*@

                        @*<table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap " style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                            <thead>

                                <tr>
                                    <th>NO</th>
                                    <th>Service Provider</th>
                                    <th>Operater Name</th>
                                    <th  colspan="2" style="text-align:center;">@userName</th>

                                </tr>
                                <tr><th></th><th></th> <th></th><th>Commission</th><th>Amount</th></tr>
                            </thead>
                            <tbody id="rechargesdata">*@
                        @RenderPage("~/Views/Shared/Preloader/_grid.cshtml", new { Id = 4 })
                        @*</tbody>
                            </table>*@

                    </div>
                }
                @*}*@
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <script src="~/Content/globalDomain.js"></script>
    @*@Scripts.Render("~/bundles/datatablejs")*@

    <!--<script src="~/plugins/datatables/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/dataTables.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/dataTables.buttons.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/jszip.min.js" type="text/javascript"></script>-->
    @*<script src="~/plugins/datatables/pdfmake.min.js" type="text/javascript"></script>*@
    <!--<script src="~/plugins/datatables/vfs_fonts.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.html5.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.print.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.colVis.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/dataTables.responsive.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/responsive.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/scripts/pages/jquery.datatable.init.js" type="text/javascript"></script>
    <script src="~/plugins/sweet-alert2/sweetalert2.min.js"></script>
    <script src="~/scripts/pages/jquery.sweet-alert.init.js"></script>-->
    <script type="text/javascript">

        $(".singleselect").select2();
        var UserType = $("#UserType").val();
        var Id = $("#Id").val();
        var ServiceId = $("#ServiceId").val();
        var IsdefaultPartyId = $("#IsdefaultPartyId").val();
        GenerateRechargeData(0, UserType, ServiceId, Id);
        $("#Recharge_Id").click(function () {
            var OperaterId = $("#OperaterId").val();
            GenerateInsertRechargeData(OperaterId, UserType, ServiceId, Id, IsdefaultPartyId);
            /*       GenerateInsertRechargeData(OperaterId, UserType, ServiceId,Id);*/
        });
        $("#OperaterId").change(function () {
            var OperaterId = $("#OperaterId").val();

            GenerateRechargeData(OperaterId, UserType, ServiceId, Id);
        });
        function GenerateRechargeData(OperaterId, UserType, ServiceId, Id) {
            debugger;

            $.ajax({
                url: GetglobalDomain() + '/AdminAjaxRequestPage/GenerateRechargesUserWise?OperaterId=' + OperaterId + '&UserType=' + UserType + '&ServiceId=' + ServiceId + '&Id=' + Id,
                type: 'POST',
                dataType: "text",
                success: function (response) {
                    debugger;

                    $("#rechargesdata").html(response);



                }
            });
            return false;
        }
        function GenerateInsertRechargeData(OperaterId, UserType, ServiceId, Id, IsdefaultPartyId) {
            debugger;

            $.ajax({
                url: GetglobalDomain() + '/AdminAjaxRequestPage/InsertUserRecharges?OperaterId=' + OperaterId + '&UserType=' + UserType + '&ServiceId=' + ServiceId + ' &Id=' + Id + '&IsdefaultPartyId=' + IsdefaultPartyId,
                type: 'POST',
                dataType: "json",
                success: function (response) {
                    debugger;
                    var OperaterId = $("#OperaterId").val();
                    GenerateRechargeData(OperaterId, UserType, ServiceId, Id);



                }
            });
            return false;
        }
    </script>
}



