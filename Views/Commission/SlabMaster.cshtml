
@using NewZapures_V2.Models
@{

    ViewBag.Title = "SlabMaster";
    Layout = "~/Views/Shared/_Layout.cshtml";
    List<CustomMaster> ServiceType = new List<CustomMaster>();
    if (ViewBag.ServiceType != null)
    {
        ServiceType = (List<CustomMaster>)ViewBag.ServiceType;
    }
}


@section styles{-->  @*@Styles.Render("~/bundles/datatable");*@\
<link href="~/plugins/datatables/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link href="~/plugins/datatables/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link href="~/plugins/datatables/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">


}
<div class="row">
    <div class="col-sm-12">
        <div class="page-title-box">
            <div class="float-right">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">Zapures</li>

                    <li class="breadcrumb-item active">Slab Details</li>
                </ol>
            </div>
            <h4 class="page-title">@ViewBag.Title</h4>
        </div><!--end page-title-box-->
    </div><!--end col-->
</div>
<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header">
                <h4 class="mt-0 header-title float-left">Slab Master</h4>
            </div>
            <div class="card-body">
                @using (Html.BeginForm("SlabMaster", "Commission", FormMethod.Post, new { @class = "formcreateupdate", @id = "frmAddUpdate", enctype = "multipart/form-data" }))
                {
                    <div class="form-group  is-empty row">
                        <div class="col-sm-4">
                            <select class="singleselect" id="ServiceId" name="iSerId" required>
                                <option value="" disabled selected hidden>Select Service Name</option>

                                @{
                                    foreach (var item in ServiceType)
                                    {

                                        <option @(Model != null && Model.ServiceType == item.Id ? "selected" : "") value="@item.Id">@item.text</option>
                                    }
                                }
                            </select>

                        </div>
                        <div class="col-sm-3">
                            <input name="iTxnAmtFm" id="FromTransaction" type="number" value="" class="form-control" placeholder="From Transaction Amount" required>
                        </div>
                        <div class="col-sm-3">
                            <input name="iTxnAmtTo" id="ToTransaction" type="number" value="" class="form-control" placeholder="To Transaction Amount" required>
                        </div>
                    </div>
                    <div class="form-group  is-empty row">
                        <label for="nameInput" class="col-sm-1 control-label">Status</label>
                        <div class="col-sm-2 custom-control custom-switch switch-success">
                            <input type="checkbox" class="custom-control-input" id="Status" name="iSts" value="0">
                            <label class="custom-control-label" for="Status"></label>
                        </div>
                        @*</div>
                            <div class="form-group  is-empty row">*@
                        <label for="nameInput" class="col-sm-1 control-label" style="
    margin-left: -180px;">RangSet</label>
                        <div class="col-sm-2 custom-control custom-switch switch-success">
                            <input type="checkbox" class="custom-control-input" id="RangSet" name="bRng" value="0">
                            <label class="custom-control-label" for="RangSet"></label>
                        </div>
                        <div class="col-sm-1">
                            <button class=" btn btn-primary" type="button" id="Reset"> Reset </button>
                        </div>
                        <div class="col-sm-1">
                            <button class=" btn btn-primary" type="submit"> Save </button>
                        </div>
                    </div>
                }
                <div class="form-group is-empty row">
                    <table id="datatable-buttons" class="table table-striped " style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                        <thead>

                            <tr>
                                <th>No</th>
                                <th>Transaction Amount From </th>
                                <th>Transaction Amount To </th>
                                <th>Status</th>
                                <th>Rang Set</th>

                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="DataSlabMaster">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/plugins/datatables/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/dataTables.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/dataTables.buttons.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/jszip.min.js" type="text/javascript"></script>
    @*<script src="~/plugins/datatables/pdfmake.min.js" type="text/javascript"></script>*@
    <script src="~/plugins/datatables/vfs_fonts.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.html5.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.print.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/buttons.colVis.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/dataTables.responsive.min.js" type="text/javascript"></script>
    <script src="~/plugins/datatables/responsive.bootstrap4.min.js" type="text/javascript"></script>
    <script src="~/scripts/pages/jquery.datatable.init.js" type="text/javascript"></script>
    <script src="~/Content/globalDomain.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
    <script type="text/javascript">
        $(".singleselect").select2();
        $('input[type="checkbox"]').change(function () {

            var id = $(this).val() == 0 ? 1 : 0;
            $(this).val(id)
            console.log(id);

        });
        $('#ServiceId').on('change', (e) => {
            var Id = document.getElementById('ServiceId').value;
            GenerateSlabData(Id);
        })
        function GenerateSlabData(Id) {


            $.ajax({
                url: GetglobalDomain() + '/AdminAjaxRequestPage/GenerateSlabData?Id=' + Id,
                type: 'POST',
                dataType: "text",
                success: function (response) {
                    debugger;

                    $("#DataSlabMaster").html(response);



                }
            });
            return false;
        }

        function StatusChange(colname, id, status) {
            $.ajax({
                url: GetglobalDomain() + '/AdminAjaxRequestPage/UpdateSlabData?Type=' + colname + '&Id=' + id + '&status=' + status,
                type: 'POST',
                dataType: "text",
                success: function (response) {
                    debugger;
                    var data = JSON.parse(response);

                    if (response.IsValid = 1) {
                        var msg = data['msg'];
                        Swal.fire({
                            position: 'center',
                            icon: 'success',
                            title: msg,
                            showConfirmButton: false,
                            timer: 3000
                        })
                        var ids = document.getElementById('ServiceId').value;
                        GenerateSlabData(ids);
                    }




                }
            });
            return false;
        }
        function DeleteData(colname, id, status) {
            var Id = id;

            /*  var TypeId = $(this).attr("name");*/
            $.confirm({

                title: 'Remove Confirmation',
                content: 'Are you sure to remove record',
                type: 'red',
                typeAnimated: true,
                animation: 'rotate',
                closeAnimation: 'scale',
                buttons: {
                    Confirm: {
                        text: 'YES',
                        btnClass: 'btn-red',
                        action: function () {



                            var Params = JSON.stringify({
                                Type: 'Delete',
                                id: Id,
                                status: 2


                            });
                            /* ShowBALoader("LoaderBASinup1");*/
                            $.ajax({
                                url: GetglobalDomain() + "/AdminAjaxRequestPage/UpdateSlabData",//globaUserProperties.domain +
                                type: 'POST',
                                dataType: "json",
                                data: Params,
                                contentType: "application/json",
                                success: function (response) {


                                    debugger;
                                    if (response.IsValid = 1) {
                                        Swal.fire({
                                            position: 'center',
                                            icon: 'success',
                                            title: 'Record Deleted Successfully!',
                                            showConfirmButton: false,
                                            timer: 3000
                                        })
                                        $("#tr_" + Id).remove();
                                    }

                                },

                            });

                        }
                    },
                    close: {
                        text: 'NO',
                        action: function () { }
                    }
                }
            });
        }
    </script>
}